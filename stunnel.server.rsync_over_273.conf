# rsync over stunnel: 
# server stunnel.conf
# 
# http://www.netbits.us/docs/stunnel_rsync.html
#
# this uses tcp-wrappers to control the access to these ports.
# 
# rsync:873 -> stunnel:273 -----> server stunnel:273 -> rsync:873
# 
# Before running this script:
#
# add to server /etc/services:
# ssyncd 273/tcp # secure rsync over stunnel
# 
# add to server /etc/hosts.allow:
# ssyncd : A.B.C.D <server IP>
#
# open port 273:
# (ours)	iptables -A INPUT -p tcp --dport 273 -j ACCEPT
# (theirs)	iptables -A FORWARD -p tcp -j ACCEPT --dport 273 -m state --state NEW
#
# <run stunnel>
#
# test rsync via the client:
# /usr/bin/rsync -vv localhost::

output	= /var/log/stunnel4/stunnel.log
cert	= /etc/stunnel/stunnel.fullchain.pem
key		= /etc/stunnel/stunnel.key.pem
pid		= /var/run/stunnel4/stunnel.pid
client	= no

debug = 7
foreground = yes

[rsync]
accept = 273
connect = 873